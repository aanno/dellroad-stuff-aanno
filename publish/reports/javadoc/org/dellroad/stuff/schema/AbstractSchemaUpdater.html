<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_33) on Fri Aug 24 12:21:45 CDT 2012 -->
<TITLE>
AbstractSchemaUpdater (Java Class Library API)
</TITLE>

<META NAME="date" CONTENT="2012-08-24">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AbstractSchemaUpdater (Java Class Library API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/AbstractSchemaUpdater.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSpringSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/dellroad/stuff/schema/AbstractSchemaUpdater.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AbstractSchemaUpdater.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.dellroad.stuff.schema</FONT>
<BR>
Class AbstractSchemaUpdater&lt;D,T&gt;</H2>
<PRE>
<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.dellroad.stuff.schema.AbstractSchemaUpdater&lt;D,T&gt;</B>
</PRE>
<DL>
<DT><DT><B>Type Parameters:</B><DD><CODE>D</CODE> - database type<DD><CODE>T</CODE> - database transaction type</DL>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectSchemaUpdater.html" title="class in org.dellroad.stuff.pobj">PersistentObjectSchemaUpdater</A>, <A HREF="../../../../org/dellroad/stuff/schema/SQLSchemaUpdater.html" title="class in org.dellroad.stuff.schema">SQLSchemaUpdater</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public abstract class <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.51"><B>AbstractSchemaUpdater&lt;D,T&gt;</B></A><DT>extends <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
Handles the initialization and schema maintenance of a database.

 <p>
 In this class, a <b>database</b> is some stateful object whose structure and/or content may need to change over time.
 <b>Updates</b> are uniquely named objects capable of making such changes. Databases are also capable of storing the
 names of the already-applied updates.

 <p>
 Given a database and a set of current updates, this class will ensure that a database is initialized if necessary
 and up-to-date with respect to the updates.

 <p>
 The primary method is <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeAndUpdateDatabase(D)"><CODE>initializeAndUpdateDatabase()</CODE></A>, which will:
 <ul>
 <li>Initialize an <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#databaseNeedsInitialization(T)">empty</A> database (if necessary);</li>
 <li>Apply any outstanding <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema"><CODE>SchemaUpdate</CODE></A>s as needed, ordered properly according to
      their <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html#getRequiredPredecessors()">predecessor constraints</A>; and</li>
 <li>Keep track of which <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema"><CODE>SchemaUpdate</CODE></A>s have already been applied across restarts.</li>
 </ul>
 </p>
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#log">log</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#AbstractSchemaUpdater()">AbstractSchemaUpdater</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#apply(T, org.dellroad.stuff.schema.DatabaseAction)">apply</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction,
           <A HREF="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&nbsp;action)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Execute a database action within an existing transaction.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#applyInTransaction(D, org.dellroad.stuff.schema.DatabaseAction)">applyInTransaction</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</A>&nbsp;database,
                                     <A HREF="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&nbsp;action)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Execute a database action.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)">commitTransaction</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Commit a previously opened transaction.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#databaseNeedsInitialization(T)">databaseNeedsInitialization</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determine if the database needs initialization.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#generateMultiUpdateName(org.dellroad.stuff.schema.SchemaUpdate, int)">generateMultiUpdateName</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&nbsp;update,
                                               int&nbsp;index)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generate the update name for one action within a multi-action update.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</A>&lt;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getAllUpdateNames()">getAllUpdateNames</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the names of all updates including multi-action updates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</A>&lt;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getAppliedUpdateNames(T)">getAppliedUpdateNames</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determine which updates have already been applied to the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Comparator.html?is-external=true" title="class or interface in java.util">Comparator</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getOrderingTieBreaker()">getOrderingTieBreaker</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determine the preferred ordering of two updates that do not have any predecessor constraints
 (including implied indirect constraints) between them.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</A>&lt;? extends <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getUpdates()">getUpdates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the configured updates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeAndUpdateDatabase(D)">initializeAndUpdateDatabase</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</A>&nbsp;database)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Perform database schema initialization and updates.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeDatabase(T)">initializeDatabase</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initialize an uninitialized database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#isIgnoreUnrecognizedUpdates()">isIgnoreUnrecognizedUpdates</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determine whether unrecognized updates are ignored or cause an exception.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#isValidUpdateName(java.lang.String)">isValidUpdateName</A></B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;updateName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determine if the given schema update name is valid.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#openTransaction(D)">openTransaction</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</A>&nbsp;database)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Begin a transaction on the given database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#recordUpdateApplied(T, java.lang.String)">recordUpdateApplied</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction,
                                       <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Record an update as having been applied to the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected abstract &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#rollbackTransaction(T)">rollbackTransaction</A></B>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Roll back a previously opened transaction.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)">setIgnoreUnrecognizedUpdates</A></B>(boolean&nbsp;ignoreUnrecognizedUpdates)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Configure behavior when an unknown update is registered as having already been applied in the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setUpdates(java.util.Collection)">setUpdates</A></B>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</A>&lt;? extends <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&gt;&nbsp;updates)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Configure the updates.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="log"><!-- --></A><H3>
log</H3>
<PRE>
protected final <A HREF="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</A> <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.53"><B>log</B></A></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AbstractSchemaUpdater()"><!-- --></A><H3>
AbstractSchemaUpdater</H3>
<PRE>
public <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.51"><B>AbstractSchemaUpdater</B></A>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getUpdates()"><!-- --></A><H3>
getUpdates</H3>
<PRE>
public <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</A>&lt;? extends <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&gt; <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.64"><B>getUpdates</B></A>()</PRE>
<DL>
<DD>Get the configured updates. This property is required.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>configured updates<DT><B>See Also:</B><DD><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setUpdates(java.util.Collection)"><CODE>setUpdates()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setUpdates(java.util.Collection)"><!-- --></A><H3>
setUpdates</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.86"><B>setUpdates</B></A>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</A>&lt;? extends <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&gt;&nbsp;updates)</PRE>
<DL>
<DD>Configure the updates.
 This should be the set of all updates that may need to be applied to the database.

 <p>
 For any given application, ideally this set should be "write only" in the sense that once an update is added to the set
 and applied to one or more actual databases, the update and its name should thereafter never change. Otherwise,
 it would be possible for different databases to have inconsistent schemas even though the same updates were recorded.

 <p>
 Furthermore, if not configured to <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)">ignore unrecognized updates already applied</A>
 (the default behavior), then updates must never be removed from this set as the application evolves;
 see <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)"><CODE>setIgnoreUnrecognizedUpdates(boolean)</CODE></A> for more information on the rationale.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>updates</CODE> - all updates; each update must have a unique <A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html#getName()"><CODE>name</CODE></A>.<DT><B>See Also:</B><DD><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getUpdates()"><CODE>getUpdates()</CODE></A>, 
<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)"><CODE>setIgnoreUnrecognizedUpdates(boolean)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="isIgnoreUnrecognizedUpdates()"><!-- --></A><H3>
isIgnoreUnrecognizedUpdates</H3>
<PRE>
public boolean <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.96"><B>isIgnoreUnrecognizedUpdates</B></A>()</PRE>
<DL>
<DD>Determine whether unrecognized updates are ignored or cause an exception.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>true if unrecognized updates should be ignored, false if they should cause an exception to be thrown<DT><B>See Also:</B><DD><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)"><CODE>setIgnoreUnrecognizedUpdates()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="setIgnoreUnrecognizedUpdates(boolean)"><!-- --></A><H3>
setIgnoreUnrecognizedUpdates</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.116"><B>setIgnoreUnrecognizedUpdates</B></A>(boolean&nbsp;ignoreUnrecognizedUpdates)</PRE>
<DL>
<DD>Configure behavior when an unknown update is registered as having already been applied in the database.

 <p>
 The default behavior is <code>false</code>, which results in an exception being thrown. This protects against
 accidental downgrades (i.e., running older code against a database with a newer schema), which are not supported.
 However, this also requires that all updates that might ever possibly have been applied to the database be
 present in the set of configured updates.

 <p>
 Setting this to <code>true</code> will result in unrecognized updates simply being ignored.
 This setting loses the downgrade protection but allows obsolete schema updates to be dropped over time.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ignoreUnrecognizedUpdates</CODE> - whether to ignore unrecognized updates<DT><B>See Also:</B><DD><A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#isIgnoreUnrecognizedUpdates()"><CODE>isIgnoreUnrecognizedUpdates()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="initializeAndUpdateDatabase(java.lang.Object)"><!-- --></A><A NAME="initializeAndUpdateDatabase(D)"><!-- --></A><H3>
initializeAndUpdateDatabase</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.145"><B>initializeAndUpdateDatabase</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</A>&nbsp;database)
                                 throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Perform database schema initialization and updates.

 <p>
 This method applies the following logic: if the <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#databaseNeedsInitialization(T)">database needs initialization</A>,
 then <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeDatabase(T)">initialize the database</A> and <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#recordUpdateApplied(T, java.lang.String)">record</A> each update
 as having been applied; otherwise, <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#apply(T, org.dellroad.stuff.schema.DatabaseAction)">apply</A> any <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getAppliedUpdateNames(T)">unapplied updates</A>
 as needed.

 <p>
 Note this implies the database initialization must initialize the database to its current, up-to-date state
 (with respect to the set of all available updates), not its original, pre-update state.

 <p>
 The database initialization step, and each of the update steps, is <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#applyInTransaction(D, org.dellroad.stuff.schema.DatabaseAction)">performed within
 its own transaction</A>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>database</CODE> - the database to initialize (if necessary) and update
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an update fails
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></CODE> - if this instance is not configured to <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)">ignore
 unrecognized updates</A> and an unrecognized update has already been applied
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if two configured updates have the same name
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if any configured update has a required predecessor which is not also a configured update
  (i.e., if the updates are not transitively closed under predecessors)</DL>
</DD>
</DL>
<HR>

<A NAME="isValidUpdateName(java.lang.String)"><!-- --></A><H3>
isValidUpdateName</H3>
<PRE>
public static boolean <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.182"><B>isValidUpdateName</B></A>(<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;updateName)</PRE>
<DL>
<DD>Determine if the given schema update name is valid. Valid names are non-empty and
 have no leading or trailing whitespace.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="databaseNeedsInitialization(java.lang.Object)"><!-- --></A><A NAME="databaseNeedsInitialization(T)"><!-- --></A><H3>
databaseNeedsInitialization</H3>
<PRE>
protected abstract boolean <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.195"><B>databaseNeedsInitialization</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)
                                                throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Determine if the database needs initialization.

 <p>
 If so, <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeDatabase(T)"><CODE>initializeDatabase(T)</CODE></A> will eventually be invoked.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>transaction</CODE> - open transaction
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="initializeDatabase(java.lang.Object)"><!-- --></A><A NAME="initializeDatabase(T)"><!-- --></A><H3>
initializeDatabase</H3>
<PRE>
protected abstract void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.204"><B>initializeDatabase</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)
                                    throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Initialize an uninitialized database. This should create and initialize the database schema and content,
 including whatever portion of that is used to track schema updates.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>transaction</CODE> - open transaction
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="openTransaction(java.lang.Object)"><!-- --></A><A NAME="openTransaction(D)"><!-- --></A><H3>
openTransaction</H3>
<PRE>
protected abstract <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A> <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.215"><B>openTransaction</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</A>&nbsp;database)
                              throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Begin a transaction on the given database.
 The transaction will always eventually either be
 <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)">committed</A> or <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#rollbackTransaction(T)">rolled back</A>.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>database</CODE> - database
<DT><B>Returns:</B><DD>transaction handle
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="commitTransaction(java.lang.Object)"><!-- --></A><A NAME="commitTransaction(T)"><!-- --></A><H3>
commitTransaction</H3>
<PRE>
protected abstract void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.223"><B>commitTransaction</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)
                                   throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Commit a previously opened transaction.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>transaction</CODE> - open transaction previously returned from <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#openTransaction(D)"><CODE>openTransaction()</CODE></A>
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="rollbackTransaction(java.lang.Object)"><!-- --></A><A NAME="rollbackTransaction(T)"><!-- --></A><H3>
rollbackTransaction</H3>
<PRE>
protected abstract void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.232"><B>rollbackTransaction</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)
                                     throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Roll back a previously opened transaction.
 This method will also be invoked if <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)"><CODE>commitTransaction()</CODE></A> throws an exception.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>transaction</CODE> - open transaction previously returned from <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#openTransaction(D)"><CODE>openTransaction()</CODE></A>
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="getAppliedUpdateNames(java.lang.Object)"><!-- --></A><A NAME="getAppliedUpdateNames(T)"><!-- --></A><H3>
getAppliedUpdateNames</H3>
<PRE>
protected abstract <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</A>&lt;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&gt; <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.240"><B>getAppliedUpdateNames</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction)
                                              throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Determine which updates have already been applied to the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>transaction</CODE> - open transaction
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="recordUpdateApplied(java.lang.Object,java.lang.String)"><!-- --></A><A NAME="recordUpdateApplied(T, java.lang.String)"><!-- --></A><H3>
recordUpdateApplied</H3>
<PRE>
protected abstract void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.250"><B>recordUpdateApplied</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction,
                                            <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&nbsp;name)
                                     throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Record an update as having been applied to the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>transaction</CODE> - open transaction<DD><CODE>name</CODE> - update name
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></CODE> - if the update has already been recorded in the database
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="getOrderingTieBreaker()"><!-- --></A><H3>
getOrderingTieBreaker</H3>
<PRE>
protected <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Comparator.html?is-external=true" title="class or interface in java.util">Comparator</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&gt; <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.262"><B>getOrderingTieBreaker</B></A>()</PRE>
<DL>
<DD>Determine the preferred ordering of two updates that do not have any predecessor constraints
 (including implied indirect constraints) between them.

 <p>
 The <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Comparator.html?is-external=true" title="class or interface in java.util"><CODE>Comparator</CODE></A> returned by the implementation in <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><CODE>AbstractSchemaUpdater</CODE></A> simply sorts updates by name.
 Subclasses may override if necessary.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>a <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/Comparator.html?is-external=true" title="class or interface in java.util"><CODE>Comparator</CODE></A> that sorts incomparable updates in the order they should be applied</DL>
</DD>
</DL>
<HR>

<A NAME="generateMultiUpdateName(org.dellroad.stuff.schema.SchemaUpdate, int)"><!-- --></A><H3>
generateMultiUpdateName</H3>
<PRE>
protected <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.277"><B>generateMultiUpdateName</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&nbsp;update,
                                         int&nbsp;index)</PRE>
<DL>
<DD>Generate the update name for one action within a multi-action update.

 <p>
 The implementation in <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><CODE>AbstractSchemaUpdater</CODE></A> just adds a suffix using <code>index + 1</code>, padded to
 5 digits, producing names like <code>name-00001</code>, <code>name-00002</code>, etc.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>update</CODE> - the schema update<DD><CODE>index</CODE> - the index of the action (zero based)<DT><B>See Also:</B><DD><A HREF="../../../../org/dellroad/stuff/schema/SchemaUpdate.html#isSingleAction()"><CODE>SchemaUpdate.isSingleAction()</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getAllUpdateNames()"><!-- --></A><H3>
getAllUpdateNames</H3>
<PRE>
protected <A HREF="http://download.oracle.com/javase/6/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</A>&lt;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A>&gt; <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.284"><B>getAllUpdateNames</B></A>()
                                  throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Get the names of all updates including multi-action updates.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="apply(java.lang.Object,org.dellroad.stuff.schema.DatabaseAction)"><!-- --></A><A NAME="apply(T, org.dellroad.stuff.schema.DatabaseAction)"><!-- --></A><H3>
apply</H3>
<PRE>
protected void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.306"><B>apply</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&nbsp;transaction,
                     <A HREF="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&nbsp;action)
              throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Execute a database action within an existing transaction.

 <p>
 All database operations in <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><CODE>AbstractSchemaUpdater</CODE></A> are performed via this method;
 subclasses are encouraged to follow this pattern.

 <p>
 The implementation in <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><CODE>AbstractSchemaUpdater</CODE></A> simply invokes <A HREF="../../../../org/dellroad/stuff/schema/DatabaseAction.html#apply(T)"><CODE>action.apply()</CODE></A>;
 subclasses may override if desired.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<HR>

<A NAME="applyInTransaction(java.lang.Object,org.dellroad.stuff.schema.DatabaseAction)"><!-- --></A><A NAME="applyInTransaction(D, org.dellroad.stuff.schema.DatabaseAction)"><!-- --></A><H3>
applyInTransaction</H3>
<PRE>
protected void <A HREF="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.320"><B>applyInTransaction</B></A>(<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</A>&nbsp;database,
                                  <A HREF="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</A>&lt;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</A>&gt;&nbsp;action)
                           throws <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></PRE>
<DL>
<DD>Execute a database action. A new transaction will be created, used, and closed.
 Delegates to <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#apply(T, org.dellroad.stuff.schema.DatabaseAction)"><CODE>apply()</CODE></A> for the actual execution of the action.

 <p>
 If the action or <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)"><CODE>commitTransaction()</CODE></A> fails, the transaction
 is <A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#rollbackTransaction(T)">rolled back</A>.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Exception.html?is-external=true" title="class or interface in java.lang">Exception</A></CODE> - if an error occurs while accessing the database</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/AbstractSchemaUpdater.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/dellroad/stuff/schema/AbstractSpringSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/dellroad/stuff/schema/AbstractSchemaUpdater.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AbstractSchemaUpdater.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
