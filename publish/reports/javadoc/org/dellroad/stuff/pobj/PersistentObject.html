<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_29) on Wed Jan 18 10:34:29 CST 2012 -->
<TITLE>
PersistentObject (Java Class Library API)
</TITLE>

<META NAME="date" CONTENT="2012-01-18">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PersistentObject (Java Class Library API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PersistentObject.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentFileTransaction.html" title="class in org.dellroad.stuff.pobj"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/dellroad/stuff/pobj/PersistentObject.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PersistentObject.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.dellroad.stuff.pobj</FONT>
<BR>
Class PersistentObject&lt;T&gt;</H2>
<PRE>
<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</A>
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.dellroad.stuff.pobj.PersistentObject&lt;T&gt;</B>
</PRE>
<DL>
<DT><DT><B>Type Parameters:</B><DD><CODE>T</CODE> - type of the root persistent object</DL>
<HR>
<DL>
<DT><PRE>public class <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.64"><B>PersistentObject&lt;T&gt;</B></A><DT>extends <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></DL>
</PRE>

<P>
Main class for Simple XML Persistence Objects (POBJ).

 <p>
 The model is that there is a root Java object which, together with the tree of objects is points to,
 represents the current "database" state. XML (de)serializers provide correspondence between the in-memory
 Java object tree and an XML document, and define what the "tree" is. Just like the persistent XML file that
 backs it, the object tree is read and written in its entirety, atomically, and so is always treated as "one thing".
 In other words, the object tree is passed by value.

 <p>
 When object tree is updated, it must pass validation checks, and then the persistent file is updated and
 listener notifications are sent out.

 <p>
 Support for optimistic locking is included. There is a current version number which is incremented each
 time the object tree is updated.

 <p>
 Support for delayed write-back is included. This allows modifications that occur in rapid succession to be consolidated
 into a single filesystem write operation.

 <p>
 File system writes use the rename operation for atomicity.

 <p>
 Instances must be supplied with a <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><CODE>PersistentObjectDelegate</CODE></A> that knows how to validate the root object
 and perform the XML conversions.
<P>

<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../org/dellroad/stuff/pobj/package-summary.html"><CODE>org.dellroad.stuff.pobj</CODE></A></DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#log">log</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected </CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#PersistentObject(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File, long)">PersistentObject</A></B>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</A>&lt;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&gt;&nbsp;delegate,
                                 <A HREF="http://download.oracle.com/javase/6/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A>&nbsp;file,
                                 long&nbsp;writeDelay)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)">addListener</A></B>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</A>&lt;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&gt;&nbsp;listener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add a listener.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getDelegate()">getDelegate</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the configured <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><CODE>PersistentObjectDelegate</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getPersistentFile()">getPersistentFile</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the persistent file containing the XML form of the persisted object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()">getRoot</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Atomically read the root object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()">getSharedRoot</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get a shared copy of the root object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getVersion()">getVersion</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the version of the current root.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getWriteDelay()">getWriteDelay</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#notifyListeners(long, T, T)">notifyListeners</A></B>(long&nbsp;newVersion,
                               <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;oldRoot,
                               <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;newRoot)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notify listeners.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read()">read</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Read the persistent file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#removeListener(org.dellroad.stuff.pobj.PersistentObjectListener)">removeListener</A></B>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</A>&lt;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&gt;&nbsp;listener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove a listener.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T)">setRoot</A></B>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;newRoot)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Atomically update the root object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)">setRoot</A></B>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;newRoot,
               long&nbsp;expectedVersion)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Atomically update the root object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#start()">start</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Start this instance.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#stop()">stop</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stop this instance.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get a simple string description of this instance.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T)">write</A></B>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;obj)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write the persistent file.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.<A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</A>, <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="log"><!-- --></A><H3>
log</H3>
<PRE>
protected final <A HREF="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.66"><B>log</B></A></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="PersistentObject(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File, long)"><!-- --></A><H3>
PersistentObject</H3>
<PRE>
protected <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.93"><B>PersistentObject</B></A>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</A>&lt;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&gt;&nbsp;delegate,
                           <A HREF="http://download.oracle.com/javase/6/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A>&nbsp;file,
                           long&nbsp;writeDelay)</PRE>
<DL>
<DD>Constructor.

 <p>
 The <code>writeDelay</code> is the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>delegate</CODE> - delegate supplying required operations<DD><CODE>file</CODE> - the file used to persist<DD><CODE>writeDelay</CODE> - write delay in milliseconds, or zero for immediate write-back
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if <code>writeDelay</code> is negative</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getPersistentFile()"><!-- --></A><H3>
getPersistentFile</H3>
<PRE>
public <A HREF="http://download.oracle.com/javase/6/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.108"><B>getPersistentFile</B></A>()</PRE>
<DL>
<DD>Get the persistent file containing the XML form of the persisted object.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getWriteDelay()"><!-- --></A><H3>
getWriteDelay</H3>
<PRE>
public long <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.118"><B>getWriteDelay</B></A>()</PRE>
<DL>
<DD>Get the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>write delay in milliseconds, or zero for immediate write-back</DL>
</DD>
</DL>
<HR>

<A NAME="getVersion()"><!-- --></A><H3>
getVersion</H3>
<PRE>
public long <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.128"><B>getVersion</B></A>()</PRE>
<DL>
<DD>Get the version of the current root.

 <p>
 This returns a value which increases monotonically with each update.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="start()"><!-- --></A><H3>
start</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.137"><B>start</B></A>()</PRE>
<DL>
<DD>Start this instance. Does nothing if already started.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</A></CODE> - if an error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="stop()"><!-- --></A><H3>
stop</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.162"><B>stop</B></A>()</PRE>
<DL>
<DD>Stop this instance. Does nothing if already stopped.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</A></CODE> - if a delayed write back is pending and error occurs in <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T)"><CODE>write(T)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getRoot()"><!-- --></A><H3>
getRoot</H3>
<PRE>
public <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.203"><B>getRoot</B></A>()</PRE>
<DL>
<DD>Atomically read the root object.

 <p>
 If there is no persistent file and no value has been set, null will be returned.
 This condition is checked on each invocation of this method, so the persistent file
 is allowed to appear at any time. However, this is the only case where modifications
 to the underlying file are allowed while this instance is started.

 <p>
 This returns a deep copy of the current root object; any subsequent modifications are not written back.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the current root instance, or be null if no value has ever been written
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></CODE> - if this instance is not started
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</A></CODE> - if an error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="getSharedRoot()"><!-- --></A><H3>
getSharedRoot</H3>
<PRE>
public <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.227"><B>getSharedRoot</B></A>()</PRE>
<DL>
<DD>Get a shared copy of the root object.

 <p>
 This returns a copy of the root object, but it returns the same copy each time (until the next change).
 This method is more efficient than <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><CODE>getRoot()</CODE></A> when used by callers who mutually agree not to
 modify the returned object.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setRoot(java.lang.Object,long)"><!-- --></A><A NAME="setRoot(T, long)"><!-- --></A><H3>
setRoot</H3>
<PRE>
public final void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.254"><B>setRoot</B></A>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;newRoot,
                          long&nbsp;expectedVersion)</PRE>
<DL>
<DD>Atomically update the root object.

 <p>
 The given object is deep-copied and the copy replaces the current root.

 <p>
 If <code>version</code> is non-zero, then if the current version is not equal to it,
 a <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj"><CODE>PersistentObjectVersionException</CODE></A> exception is thrown. This mechanism
 can be used for optimistic locking.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>newRoot</CODE> - new persistent object<DD><CODE>expectedVersion</CODE> - expected current version number, or zero for none
<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if <code>newRoot</code> is null
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if <code>version</code> is negative
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</A></CODE> - if this instance is not started
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</A></CODE> - if an error occurs
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectVersionException</A></CODE> - if <code>version</code> is non-zero and not equal to the current version
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</A></CODE> - if the new root has validation errors</DL>
</DD>
</DL>
<HR>

<A NAME="setRoot(java.lang.Object)"><!-- --></A><A NAME="setRoot(T)"><!-- --></A><H3>
setRoot</H3>
<PRE>
public final void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.307"><B>setRoot</B></A>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;newRoot)</PRE>
<DL>
<DD>Atomically update the root object.

 <p>
 The is a convenience method, equivalent to:
  <blockquote>
  <code><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><CODE>setRoot</CODE></A>(newRoot, 0)</code>
  </blockquote>

 <p>
 This method cannot throw <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj"><CODE>PersistentObjectVersionException</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="addListener(org.dellroad.stuff.pobj.PersistentObjectListener)"><!-- --></A><H3>
addListener</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.316"><B>addListener</B></A>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</A>&lt;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&gt;&nbsp;listener)</PRE>
<DL>
<DD>Add a listener.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if <code>listener</code> is null</DL>
</DD>
</DL>
<HR>

<A NAME="removeListener(org.dellroad.stuff.pobj.PersistentObjectListener)"><!-- --></A><H3>
removeListener</H3>
<PRE>
public void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.327"><B>removeListener</B></A>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</A>&lt;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&gt;&nbsp;listener)</PRE>
<DL>
<DD>Remove a listener.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.337"><B>toString</B></A>()</PRE>
<DL>
<DD>Get a simple string description of this instance. Used for (among other things) log messages.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</A></CODE> in class <CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</A></CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getDelegate()"><!-- --></A><H3>
getDelegate</H3>
<PRE>
protected <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.344"><B>getDelegate</B></A>()</PRE>
<DL>
<DD>Get the configured <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><CODE>PersistentObjectDelegate</CODE></A>.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="read()"><!-- --></A><H3>
read</H3>
<PRE>
protected <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A> <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.353"><B>read</B></A>()</PRE>
<DL>
<DD>Read the persistent file.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</A></CODE> - if an error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="write(java.lang.Object)"><!-- --></A><A NAME="write(T)"><!-- --></A><H3>
write</H3>
<PRE>
protected final void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.399"><B>write</B></A>(<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;obj)</PRE>
<DL>
<DD>Write the persistent file.

 <p>
 A temporary file is created in the same directory and then renamed to provide for an atomic update.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</A></CODE> - if <code>obj</code> is null
<DD><CODE><A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</A></CODE> - if an error occurs</DL>
</DD>
</DL>
<HR>

<A NAME="notifyListeners(long,java.lang.Object,java.lang.Object)"><!-- --></A><A NAME="notifyListeners(long, T, T)"><!-- --></A><H3>
notifyListeners</H3>
<PRE>
protected void <A HREF="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.465"><B>notifyListeners</B></A>(long&nbsp;newVersion,
                               <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;oldRoot,
                               <A HREF="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</A>&nbsp;newRoot)</PRE>
<DL>
<DD>Notify listeners.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>newVersion</CODE> - the version number associated with the new root</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PersistentObject.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentFileTransaction.html" title="class in org.dellroad.stuff.pobj"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/dellroad/stuff/pobj/PersistentObject.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PersistentObject.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
